# sketch2prompt

## Purpose

> "I build tools that help humans define systems so AI can stop guessing."

Sketch2Prompt is a **system definition tool** for software architecture. It transforms a builder's mental model into an explicit, structured specification that **constrains** downstream AI behavior.

The core problem it solves: **underspecified intent**. AI coding agents hallucinate structure, invent inconsistent conventions, and degrade coherence over time—not because models are weak, but because they're given ambiguous input.

### What Sketch2Prompt IS

- A **semantic boundary-setting tool** that defines what exists, why it exists, and where responsibilities lie
- An **intent-freezing mechanism** that captures architectural decisions before entropy sets in
- A **constraint generator** that produces specifications AI agents can reliably follow

### What Sketch2Prompt IS NOT

- A diagramming tool for documentation
- An architecture or code generator
- A framework prescriber or implementation enforcer
- A performance optimizer or correctness validator

**Its job ends once structure and intent are clear.** Everything else is downstream.

### Success Criteria

Sketch2Prompt succeeds when:

- AI agents stop guessing architecture
- Follow-up prompts become **shorter**, not longer
- Refactors feel safer instead of scarier
- New features slot into existing structure instead of creating sprawl
- Output feels like: *"This system already has rules."*

### Philosophical Stance

- Humans are better at defining intent
- Agents are better at executing within constraints
- Systems degrade without explicit boundaries

**Freeze intent early**, before entropy sets in.

---

## Output Format

The primary deliverable is structured specifications that AI coding assistants (Cursor, Windsurf, Claude) can consume:

1. **Architecture Overview** - Components grouped by type with clear responsibilities
2. **Responsibility Boundaries** - What exists, what's allowed, what's forbidden
3. **Build Order** - Recommended implementation sequence by component type
4. **Component Guidance** - Per-component notes and watch-fors

**Key design decision:** Edges are visual-only. Relationships are implied by component metadata, not parsed from canvas connections. This keeps the specification deterministic and focused on boundaries rather than flow.

---

## Tech Stack

- npm, Vite 7, React 19, TypeScript (strict)
- @xyflow/react 12 (React Flow) for canvas
- Zod for schema validation
- Tailwind CSS v4 for styling
- Zustand + zundo for state with undo/redo

## Commands

- `npm run dev` - Start dev server
- `npm run build` - Production build
- `npm run lint` - ESLint check
- `npm run format` - Prettier format

## Architecture

```
/src
  /components - React components (Canvas, Inspector, Toolbar, ExportDrawer)
  /core       - Business logic (model, schema, export/import)
  /app        - App shell and routing
  /styles     - Global styles
```

## Key Patterns

- React Flow handles all canvas state; our store syncs to it
- Zod schemas validate all I/O boundaries (import/export)
- Export functions are **pure transformations** (diagram → structured spec)
- No external API calls—output is consumed by external tools, not generated by them

## Testing

- Vitest for unit tests on `/core` functions
- Focus on export/import round-trip integrity
- Schema validation coverage

---

## Version & Pattern Enforcement

### Minimum Versions (enforce strictly)

| Package | Min Version | Rationale |
|---------|-------------|-----------|
| React | 19.x | Use React 19 features (Actions, useOptimistic, use()) |
| Vite | 7.x | ESM-only, baseline-widely-available target |
| @xyflow/react | 12.x | Dark mode, SSR support, new API |
| Tailwind CSS | 4.x | CSS-first config, @theme directive |
| Node.js | 20.19+ | Required by Vite 7 |

### Modern Patterns (required)

**React 19:**
- Use `use()` for async data in render
- Use `useOptimistic` for optimistic UI updates
- Use `useTransition` for non-urgent updates
- NO: class components, legacy context, string refs

**Tailwind v4:**
- Use CSS-first configuration (`@theme` in CSS, not JS config)
- Use `@import "tailwindcss"` (not @tailwind directives)
- NO: tailwind.config.js (unless absolutely necessary)

**Vite 7:**
- Target is `baseline-widely-available`
- ESM imports only (no CJS require)

**TypeScript:**
- Strict mode enabled
- Use `satisfies` for type narrowing with inference
- NO: `any`, enums (use const objects), namespaces

### Before Adding Dependencies

1. Check if functionality exists in React 19 or native CSS/Tailwind v4
2. Verify package supports React 19 + Vite 7
3. Prefer packages with ESM exports

---

## Project Management

### Status Tracking

`.claude/STATUS.md` tracks current phase, milestone, and progress. **Update after every milestone.**

### Phase Documentation

Implementation phases live in `.claude/phases/`:
- `001-foundation.md` - Bootstrap, Types, Store
- `002-canvas.md` - React Flow, Custom Nodes
- `003-ui-panels.md` - Toolbar, Inspector
- `004-export.md` - Prompt, JSON, Drawer
- `005-polish.md` - Undo/Redo, Theme, Tests

Reference the relevant phase file before starting work.

---

## Git Commits

- Use conventional commits format (`feat:`, `fix:`, `docs:`, etc.)
- Keep commits lean and professional
- **NO AI attribution** - no "Generated with Claude" or "Co-Authored-By" footers
- Focus on what changed, not how it was created

---

## BMAD Integration

This project uses **BMAD Method v6** for structured workflows. Framework is in `_bmad/`, slash commands in `.claude/commands/bmad/`.

### Quick Reference

```bash
/bmad:bmm:workflows:workflow-status    # Check current state
/bmad:bmm:workflows:create-tech-spec   # Create technical specification
/bmad:bmm:workflows:dev-story          # Execute a story
/bmad:bmm:workflows:code-review        # Code review
```

### Agent Delegation

For non-trivial work, delegate to specialized agents:
- **Analyst** - Research, product briefs
- **PM** - PRD, tech-specs, stories
- **Architect** - System architecture
- **DEV** - Implementation, code review

See `.claude/BMAD.md` for detailed reference.
